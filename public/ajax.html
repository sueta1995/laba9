<!DOCTYPE html>
<html>
<head>
    <title>Laba9</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="csrf-param" content="authenticity_token" />
    <meta name="csrf-token" content="dp8xmJ6QbcehVuURs_ExDeJIe3s44vRSb2YGahfhnv1BAARYKl508Wp9sIS9a0KaslmeRTgTpf9kv0IugTbnag" />
	<link rel="stylesheet" href="/assets/application-e0cf9d8fcb18bf7f909d8d91a5e78499f82ac29523d475bf3a9ab265d5e2b451.css" data-turbo-track="reload" />
	<script type="importmap" data-turbo-track="reload">
    {
        "imports": {
            "application": "/assets/application-37f365cbecf1fa2810a8303f4b6571676fa1f9c56c248528bc14ddb857531b95.js",
            "@hotwired/turbo-rails": "/assets/turbo.min-7ab2ea9f35bae4a4d65b552f9b93524099f267a8ba3a2e07002aaa7bff8ae4cf.js",
            "@hotwired/stimulus": "/assets/stimulus.min-2dae3fdcdb1a5ee8172d3dc02a2a10cd6d5f022cc7782b3888cedc06bab7388a.js",
            "@hotwired/stimulus-loading": "/assets/stimulus-loading-1fc59770fb1654500044afd3f5f6d7d00800e5be36746d55b94a2963a7a228aa.js",
            "controllers/application": "/assets/controllers/application-368d98631bccbf2349e0d4f8269afb3fe9625118341966de054759d96ea86c7e.js",
            "controllers/hello_controller": "/assets/controllers/hello_controller-549135e8e7c683a538c3d6d517339ba470fcfb79d62f738a0a089ba41851a554.js",
            "controllers": "/assets/controllers/index-2db729dddcc5b979110e98de4b6720f83f91a123172e87281d5a58410fc43806.js"
        }
    }
    </script>
    <script>
        calc_url= location.protocol + "//" + location.host + "/calculates/create.json"

        function send_query() {
            var frm = document.forms.calc_form;
            var param_str = "";
        
            param_str = "?" + "numbers=" + frm.numbers.value;
            
            if (param_str == "") return false;

            var my_JSON_object = {};
            var http_request = new XMLHttpRequest();
    
            http_request.open("GET", calc_url+param_str, true);
            http_request.onreadystatechange = function () {
                var done = 4, ok = 200;
    
                if (http_request.readyState == done && http_request.status == ok) {
                    my_JSON_object = JSON.parse(http_request.responseText);
                    show_result(my_JSON_object);
                }
            };
        
            http_request.send(null);
            return false;
        }

        function show_result(data){
            var result = document.getElementById("result");

            result.innerHTML = `<hr/>Введеные значения: ${data.input}`;
            result.innerHTML += "<hr/><p>Все последовательности:<p>";

            for (var i = 0; i < data.all_sequences.length; i++) {
                result.innerHTML += `${i + 1}-ая: ${data.all_sequences[i]}<br><br>`;
            }

            result.innerHTML += `<hr/>Наибольшая последовательность: ${data.max_sequence}`;

            result.innerHTML += `<hr/><p>${Date()}</p>`;
        } 
    </script>
    <link rel="modulepreload" href="/assets/application-37f365cbecf1fa2810a8303f4b6571676fa1f9c56c248528bc14ddb857531b95.js">
    <link rel="modulepreload" href="/assets/turbo.min-7ab2ea9f35bae4a4d65b552f9b93524099f267a8ba3a2e07002aaa7bff8ae4cf.js">
    <link rel="modulepreload" href="/assets/stimulus.min-2dae3fdcdb1a5ee8172d3dc02a2a10cd6d5f022cc7782b3888cedc06bab7388a.js">
    <link rel="modulepreload" href="/assets/stimulus-loading-1fc59770fb1654500044afd3f5f6d7d00800e5be36746d55b94a2963a7a228aa.js">
    <script src="/assets/es-module-shims.min-d89e73202ec09dede55fb74115af9c5f9f2bb965433de1c2446e1faa6dac2470.js" async="async" data-turbo-track="reload"></script>
    <script type="module">import "application"</script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" />
</head>
	<body>
		<header></header>
		<main class="container">
            <h3>Лабораторная работа 9</h3>

            <form name="calc_form" accept-charset="UTF-8" data-remote="true" method="get">
                <label for="__________________________:">Введите числа через пробел:</label><br><br>
                <input type="text" name="numbers" id="numbers" /><br><br>
                <input type="submit" name="commit" value="Вычислить" data-disable-with="Вычислить" onclick="return send_query();" />
            </form>

            <div id="result"></div>
	    </main>
	    <footer></footer>
	</body>
</html>
